library(data.table)
library(corrplot)
data=fread('../data/steak_cleaned.csv')
# function for plotting star frequency in each word
plotWordStar <- function(stars,DTM,wordList) {
col_DTM = colnames(DTM)
DTM=as.data.frame(DTM)
for(i in 1:length(wordList)) {
index = which(col_DTM == wordList[i])
if(length(index) == 0) {
warning(paste(wordList[i],"not detected"))
next}
dtm_vec = DTM[,index]
my_star=stars[which(dtm_vec>0)]
png(paste0(wordList[i],".png"))
barplot(table(my_star)/length(my_star),main=wordList[i],xlab="Stars (1 -> 5)",ylab="Star Frequency",cex.lab = 1.5,cex.main=2.5)
dev.off()
}
}
##############################################################################
# sanity check
mylist=c("bad","worst","awful",
"mediocre","average","ordinary",
"fantastic","excellent","wonderful")
plotWordStar(data$stars_x,data,mylist,c(3,3))
plotWordStar(data$stars_x,data,mylist)
##############################################################################
# Different Types of Steak
steak_list=c('Filet','Ribeye','Sirloin','Porterhouse',
'Tomahawk','hanger','round','cube',"flank",
"skirt","strip")
steak_list=tolower(steak_list)
plotWordStar(data$stars_x,data,steak_list)
##############################################################################
# Different Types of other food
sidefood_list=c("salad","egg","cheese","potato","sushi","burger","bread",
"dessert","shrimp","beer","sandwich","lobster","cake","salmon")
plotWordStar(data$stars_x,data,sidefood_list)
##############################################################################
# Influence of meal time
non_food_list=c("lunch","dinner","brunch","breakfast")
plotWordStar(data$stars_x,data,non_food_list)
# function for plotting star frequency in each word
plotWordStar <- function(stars,DTM,wordList) {
col_DTM = colnames(DTM)
DTM=as.data.frame(DTM)
for(i in 1:length(wordList)) {
index = which(col_DTM == wordList[i])
if(length(index) == 0) {
warning(paste(wordList[i],"not detected"))
next}
dtm_vec = DTM[,index]
my_star=stars[which(dtm_vec>0)]
my_cor=cor(stars,dtm_vec)
png(paste0(wordList[i],".png"))
barplot(table(my_star)/length(my_star),main=paste0(wordList[i],"\n corr=",my_cor),xlab="Stars (1 -> 5)",ylab="Star Frequency",cex.lab = 1.5,cex.main=2.5)
dev.off()
}
}
##############################################################################
# sanity check
mylist=c("bad","worst","awful",
"mediocre","average","ordinary",
"fantastic","excellent","wonderful")
plotWordStar(data$stars_x,data,mylist)
# function for plotting star frequency in each word
plotWordStar <- function(stars,DTM,wordList) {
col_DTM = colnames(DTM)
DTM=as.data.frame(DTM)
for(i in 1:length(wordList)) {
index = which(col_DTM == wordList[i])
if(length(index) == 0) {
warning(paste(wordList[i],"not detected"))
next}
dtm_vec = DTM[,index]
my_star=stars[which(dtm_vec>0)]
my_cor=cor(stars,dtm_vec)
png(paste0(wordList[i],".png"))
barplot(table(my_star)/length(my_star),main=paste0(wordList[i],"\n corr=",my_cor),xlab="Stars (1 -> 5)",ylab="Star Frequency",cex.lab = 1.5,cex.main=2)
dev.off()
}
}
##############################################################################
# sanity check
mylist=c("bad","worst","awful",
"mediocre","average","ordinary",
"fantastic","excellent","wonderful")
plotWordStar(data$stars_x,data,mylist)
# function for plotting star frequency in each word
plotWordStar <- function(stars,DTM,wordList) {
col_DTM = colnames(DTM)
DTM=as.data.frame(DTM)
for(i in 1:length(wordList)) {
index = which(col_DTM == wordList[i])
if(length(index) == 0) {
warning(paste(wordList[i],"not detected"))
next}
dtm_vec = DTM[,index]
my_star=stars[which(dtm_vec>0)]
my_cor=cor(stars,dtm_vec)
my_cor=round(my_cor,2)
png(paste0(wordList[i],".png"))
barplot(table(my_star)/length(my_star),main=paste0(wordList[i],"\n corr=",my_cor),xlab="Stars (1 -> 5)",ylab="Star Frequency",cex.lab = 1.5,cex.main=2)
dev.off()
}
}
##############################################################################
# sanity check
mylist=c("bad","worst","awful",
"mediocre","average","ordinary",
"fantastic","excellent","wonderful")
plotWordStar(data$stars_x,data,mylist)
# function for plotting star frequency in each word
plotWordStar <- function(stars,DTM,wordList) {
col_DTM = colnames(DTM)
DTM=as.data.frame(DTM)
for(i in 1:length(wordList)) {
index = which(col_DTM == wordList[i])
if(length(index) == 0) {
warning(paste(wordList[i],"not detected"))
next}
dtm_vec = DTM[,index]
my_star=stars[which(dtm_vec>0)]
my_cor=cor(stars,dtm_vec)
my_cor=round(my_cor,4)
png(paste0(wordList[i],".png"))
barplot(table(my_star)/length(my_star),main=paste0(wordList[i],"\n corr=",my_cor),xlab="Stars (1 -> 5)",ylab="Star Frequency",cex.lab = 1.5,cex.main=2)
dev.off()
}
}
##############################################################################
# sanity check
mylist=c("bad","worst","awful",
"mediocre","average","ordinary",
"fantastic","excellent","wonderful")
plotWordStar(data$stars_x,data,mylist)
##############################################################################
# Different Types of Steak
steak_list=c('Filet','Ribeye','Sirloin','Porterhouse',
'Tomahawk','hanger','round','cube',"flank",
"skirt","strip")
steak_list=tolower(steak_list)
plotWordStar(data$stars_x,data,steak_list)
##############################################################################
# Different Types of other food
sidefood_list=c("salad","egg","cheese","potato","sushi","burger","bread",
"dessert","shrimp","beer","sandwich","lobster","cake","salmon")
plotWordStar(data$stars_x,data,sidefood_list)
##############################################################################
# Influence of meal time
non_food_list=c("lunch","dinner","brunch","breakfast")
plotWordStar(data$stars_x,data,non_food_list)
mylist3=c("service","time","price","staff","friendly","friend","atmosphere","parking","reservation",
"ambiance","wait","recommend","party","back")
plotWordStar(data$stars_x,data,mylist3,c(3,4))
mylist3=c("service","time","price","staff","friendly","friend","atmosphere","parking","reservation",
"ambiance","wait","recommend","party","back")
plotWordStar(data$stars_x,data,mylist3)
library(data.table)
data=fread('../data/steak_cleaned.csv')
# function for plotting star frequency in each word
plotWordStar <- function(stars,DTM,wordList,mfrow = c(4,4)) {
par(mfrow = mfrow)
col_DTM = colnames(DTM)
DTM=as.data.frame(DTM)
for(i in 1:length(wordList)) {
index = which(col_DTM == wordList[i])
if(length(index) == 0) {
warning(paste(wordList[i],"not detected"))
next}
dtm_vec = DTM[,index]
my_star=stars[which(dtm_vec>0)]
my_cor=cor(stars,dtm_vec)
my_cor=round(my_cor,4)
barplot(table(my_star)/length(my_star),main=paste0(wordList[i],"\n corr=",my_cor),xlab="Stars (1 -> 5)",ylab="Star Frequency",cex.lab = 1.5,cex.main=2.5)
}
par(mfrow = c(1,1))
}
##############################################################################
# sanity check
mylist=c("bad","worst","awful",
"mediocre","average","ordinary",
"fantastic","excellent","wonderful")
plotWordStar(data$stars_x,data,mylist,c(3,3))
# function for plotting star frequency in each word
plotWordStar <- function(stars,DTM,wordList,mfrow = c(4,4)) {
par(mfrow = mfrow)
col_DTM = colnames(DTM)
DTM=as.data.frame(DTM)
for(i in 1:length(wordList)) {
index = which(col_DTM == wordList[i])
if(length(index) == 0) {
warning(paste(wordList[i],"not detected"))
next}
dtm_vec = DTM[,index]
my_star=stars[which(dtm_vec>0)]
my_cor=cor(stars,dtm_vec)
my_cor=round(my_cor,4)
barplot(table(my_star)/length(my_star),main=paste0(wordList[i],"\n corr=",my_cor),xlab="Stars (1 -> 5)",ylab="Star Frequency",cex.lab = 1.5,cex.main=2)
}
par(mfrow = c(1,1))
}
##############################################################################
# sanity check
mylist=c("bad","worst","awful",
"mediocre","average","ordinary",
"fantastic","excellent","wonderful")
plotWordStar(data$stars_x,data,mylist,c(3,3))
words=fread("../data/word_freq.csv")
View(words)
words2=words[which(words$V2>4000),]
View(words2)
words_names=words2$V1
dat=data[,c("stars_x",words_names)]
words_names=as.character(words2$V1)
dat=data[,c("stars_x",words_names)]
dat=data[,c("stars_x",words_names[1:77])]
words_names[1:77]
data[,words_names[1]]
which(colnames(data)==words_names)
my_index=c()
colnames(data)
for (i in 1:length(words_names)) {
col_DTM = colnames(data)
index = which(col_DTM == words_names[i])
my_index=c(my_index,index)
}
dat=data[,c(1,my_index)]
data=as.data.frame(data)
dat=data[,c(1,my_index)]
View(dat)
my_lm=lm(stars_x~.,dat)
summary(my_lm)
words2=words[which(words$V2>3000),]
words_names=words2$V1
my_index=c()
for (i in 1:length(words_names)) {
col_DTM = colnames(data)
index = which(col_DTM == words_names[i])
my_index=c(my_index,index)
}
data=as.data.frame(data)
dat=data[,c(1,my_index)]
my_lm=lm(stars_x~.,dat)
summary(my_lm)
words2=words[which(words$V2>4000),]
words_names=words2$V1
my_index=c()
for (i in 1:length(words_names)) {
col_DTM = colnames(data)
index = which(col_DTM == words_names[i])
my_index=c(my_index,index)
}
data=as.data.frame(data)
dat=data[,c(1,my_index)]
my_lm=lm(stars_x~.,dat)
summary(my_lm)
plot(my_lm)
a=na.omit(dat)
my_lm=glm(stars_x~.,dat,family = possion())
my_lm=glm(stars_x~.,dat,family = poisson())
summary(my_lm)
plot(my_lm)
#my_lm=glm(stars_x~.,dat,family = poisson())
my_lm=lm(stars_x~.,dat)
summary(my_lm)
my_lm=glm(stars_x~.,dat,family = binomial(link = "probit"))
library(gmodels)
#my_lm=glm(stars_x~.,dat,family = binomial(link = "probit"))
my_lm=lm(stars_x~.,dat)
summary(my_lm)
ci(my_lm)
dat=data[,c(1,my_index,"good","place","great","service","time",
"egg","sushi","lobster","salmon",
"lunch","dinner","brunch","breakfast",
"ambiance","wait","recommend","party",
'filet','ribeye','sirloin','porterhouse',
'tomahawk','hanger','round','cube')]
a=c("good","place","great","service","time",
"egg","sushi","lobster","salmon",
"lunch","dinner","brunch","breakfast",
"ambiance","wait","recommend","party",
'filet','ribeye','sirloin','porterhouse',
'tomahawk','hanger','round','cube')
a %in% words_names
a[! a%in% words_names]
words_names=c(words_names,"egg")
words_names=c(words_names,"egg","lobster","salmon","lunch","brunch",
"breakfast","ambiance","recommend","party","filet",
"ribeye","sirloin","porterhouse","tomahawk","hanger","round","cube")
my_index=c()
for (i in 1:length(words_names)) {
col_DTM = colnames(data)
index = which(col_DTM == words_names[i])
my_index=c(my_index,index)
}
data=as.data.frame(data)
dat=data[,c(1,my_index)]
#my_lm=glm(stars_x~.,dat,family = binomial(link = "probit"))
my_lm=lm(stars_x~.,dat)
summary(my_lm)
words_names=c(words_names,"lobster","salmon","lunch","brunch",
"breakfast","ambiance","recommend","party","filet",
"ribeye","sirloin","porterhouse","tomahawk","hanger","round","cube")
my_index=c()
for (i in 1:length(words_names)) {
col_DTM = colnames(data)
index = which(col_DTM == words_names[i])
my_index=c(my_index,index)
}
data=as.data.frame(data)
dat=data[,c(1,my_index)]
#my_lm=glm(stars_x~.,dat,family = binomial(link = "probit"))
my_lm=lm(stars_x~.,dat)
summary(my_lm)
words2=words[which(words$V2>4000),]
words_names=words2$V1
words_names=c(words_names,"egg","obster","salmon","lunch","brunch",
"breakfast","ambiance","recommend","party","filet",
"ribeye","sirloin","porterhouse","tomahawk","hanger","round","cube")
my_index=c()
for (i in 1:length(words_names)) {
col_DTM = colnames(data)
index = which(col_DTM == words_names[i])
my_index=c(my_index,index)
}
data=as.data.frame(data)
dat=data[,c(1,my_index)]
#my_lm=glm(stars_x~.,dat,family = binomial(link = "probit"))
my_lm=lm(stars_x~.,dat)
summary(my_lm)
ci(my_lm)
kappa(cor(dat))
library(car)
vif(my_lm)
plot(my_lm)
##############################################################################
# sanity check
mylist=c("bad","worst","awful",
"mediocre","average","ordinary",
"fantastic","excellent","wonderful")
plotWordStar(data$stars_x,data,mylist,c(3,3))
